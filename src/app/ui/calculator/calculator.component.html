<div class="min-h-screen bg-stone-50 py-12 px-4">
  <div class="max-w-2xl mx-auto">
    
    <!-- Header -->
    <div class="text-center mb-12 animate-fade-in">
      <h1 class="font-script text-5xl md:text-6xl text-stone-900 mb-3">{{ lang.t().calc_title }}</h1>
      <div class="h-px w-16 bg-stone-400 mx-auto mb-3"></div>
      <p class="font-sans text-xs tracking-widest uppercase text-stone-500">{{ lang.t().calc_subtitle }}</p>
    </div>

    <!-- Calculator Card -->
    <div class="bg-white border border-stone-200 shadow-lg p-8 mb-8 animate-fade-in">
      <h2 class="font-serif text-2xl italic text-stone-800 mb-6">{{ lang.t().calc_form_title }}</h2>
      
      <form [formGroup]="form" (ngSubmit)="onCalculate()" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          
          <!-- Initial Volume -->
          <div class="flex flex-col">
            <label class="font-sans text-[10px] uppercase tracking-widest text-stone-500 mb-2">
              {{ lang.t().calc_initial_volume }}
            </label>
            <input 
              type="number" 
              formControlName="initialVolume"
              class="w-full px-4 py-3 border border-stone-300 focus:border-stone-800 focus:outline-none font-serif text-lg text-stone-800 transition-colors"
              placeholder="1000">
          </div>

          <!-- Initial ABV -->
          <div class="flex flex-col">
            <label class="font-sans text-[10px] uppercase tracking-widest text-stone-500 mb-2">
              {{ lang.t().calc_initial_abv }}
            </label>
            <input 
              type="number" 
              formControlName="initialAbv"
              step="0.1"
              class="w-full px-4 py-3 border border-stone-300 focus:border-stone-800 focus:outline-none font-serif text-lg text-stone-800 transition-colors"
              placeholder="96">
          </div>

          <!-- Target ABV -->
          <div class="flex flex-col">
            <label class="font-sans text-[10px] uppercase tracking-widest text-stone-500 mb-2">
              {{ lang.t().calc_target_abv }}
            </label>
            <input 
              type="number" 
              formControlName="targetAbv"
              step="0.1"
              class="w-full px-4 py-3 border border-stone-300 focus:border-stone-800 focus:outline-none font-serif text-lg text-stone-800 transition-colors"
              placeholder="40">
          </div>
        </div>

        <div class="flex justify-end pt-4">
          <button 
            type="submit" 
            [disabled]="form.invalid || isLoadingAi()"
            class="bg-stone-900 text-white px-10 py-4 font-sans text-xs uppercase tracking-[0.2em] hover:bg-stone-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer">
            {{ isLoadingAi() ? lang.t().calc_loading : lang.t().calc_calculate }}
          </button>
        </div>
      </form>
    </div>

    <!-- Results Section -->
    @if (result()) {
      <div class="space-y-6 animate-fade-in">
        
        <!-- Results Card -->
        <div class="bg-white border border-stone-200 shadow-lg p-8 border-l-4 border-l-indigo-500">
          <h3 class="font-serif text-xl italic text-stone-700 mb-6">{{ lang.t().calc_results }}</h3>
          
          <div class="grid grid-cols-2 gap-8">
            <div>
              <p class="font-sans text-[10px] uppercase tracking-widest text-stone-500 mb-1">{{ lang.t().calc_water_to_add }}</p>
              <p class="font-serif text-4xl text-indigo-600">
                {{ result()!.waterToAdd }} 
                <span class="text-lg text-stone-400">ml</span>
              </p>
            </div>
            <div>
              <p class="font-sans text-[10px] uppercase tracking-widest text-stone-500 mb-1">{{ lang.t().calc_final_volume }}</p>
              <p class="font-serif text-4xl text-emerald-600">
                {{ result()!.finalVolume }} 
                <span class="text-lg text-stone-400">ml</span>
              </p>
            </div>
          </div>

          <div class="mt-8 pt-6 border-t border-stone-100 flex justify-end">
            <button 
              (click)="downloadPdf()"
              class="border border-stone-300 text-stone-700 px-8 py-3 font-sans text-xs uppercase tracking-widest hover:bg-stone-50 hover:border-stone-800 transition-colors cursor-pointer">
              {{ lang.t().calc_download_pdf }}
            </button>
          </div>
        </div>

        <!-- AI Advice Card -->
        @if (aiAdvice()) {
          <div class="bg-gradient-to-br from-stone-50 to-indigo-50/30 border border-stone-200 shadow-lg p-8">
            <div class="flex items-start gap-4">
              <div class="p-3 bg-indigo-100 rounded-full text-indigo-600 flex-shrink-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>
                </svg>
              </div>
              <div>
                <h4 class="font-serif text-lg text-stone-800 mb-2">{{ lang.t().calc_maestro_says }}</h4>
                <p class="font-serif italic text-stone-600 leading-relaxed">"{{ aiAdvice() }}"</p>
              </div>
            </div>
          </div>
        }

        @if (isLoadingAi() && !aiAdvice()) {
          <div class="bg-stone-50 border border-stone-200 p-8 text-center">
            <div class="inline-block w-8 h-8 border-2 border-stone-200 border-t-stone-800 rounded-full animate-spin mb-4"></div>
            <p class="font-serif italic text-stone-500">{{ lang.t().calc_consulting }}</p>
          </div>
        }
      </div>
    }

  </div>
</div>
